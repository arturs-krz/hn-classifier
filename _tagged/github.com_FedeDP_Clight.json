{
	"_id": "14192514",
	"site": "https://github.com/FedeDP/Clight",
	"title": " Clight, small C linux user daemon to turn webcam into light sensor",
	"author": "nierro",
	"date": "2017-06-13T13:33:34.591Z",
	"tags": {
		"categories": [
			"opensource",
			"daemon",
			"c",
			"linux",
			"webcam",
			"capture-frames"
		],
		"languages": [
			"c",
			"makefile",
			"c++",
			"shell"
		]
	},
	"content": "readme.md clightclight is c daemon utility automagically change screen backlight level match ambient brightness.ambient brightness is computed capturing frames webcam.moreover, can manage screen temperature, like redshift does. was heavily inspired calise its initial intents.build depslibsystemd >= 221 (systemd/sd-bus.h)libpopt (popt.h)gsl (gsl/gsl_multifit.h)gcc clangoptional build depslibconfig (libconfig.h), config files supportruntime deps:shared objects build librariesclightdoptional runtime deps:geoclue2 automatically retrieve user location ( geoclue no user position specified disable gamma support)upower honor timeouts between captures depending ac state setted configuration (otherwise on_ac timeout be used)build switches:disable_libconfig=1 ( disable libconfig support)note optional build deps are automatically disabled they are installed build .how run clight tries be 0-conf software; therefore, installs desktop file /etc/xdg/autostart. way, matter 's de is, it is xdg-compliant, will automatically start clight. user has do nothing reboot installing clight. is needed ensure x is running clight gets started, on systemd is proper of knowing whether x has been started not.note desktop file execute \"systemctl --user start clight\"; user service then kick clightd dependency will restart itself case crash.finally, desktop file take fast screen backlight recalibration (\"clight -c\"), useful be binded a keyboard shortcut, is installed too, it show in applications menu.current features:very lightweightfully valgrind cppcheck cleanexternal signals catching (sigint/sigterm)systemd user unit autostart desktop file shippeddpms support: will check current screen powersave level won't anything screen is currently off quick single capture mode (ie: captures, change screen brightness leave) is provided, together a desktop file.gamma support: will compute sunset sunrise will automagically change screen temperature ( like redshift does)geoclue2 support: launched without [--lat|--lon] parameters, geoclue2 is available, will it get user location updates. otherwise gamma support be disabled.location received be cached clight exit. way, no internet connection is present (thus geoclue2 cannot us location) instead hanging, clight load latest available location cache file.different nightly daily captures timeout ( default 45mins during night 10mins during day; both configurable)nice log file, placed $home/.clight.log--sunrise/--sunset times user-specified support: gamma nightly temp be setted sunset , daily temp sunrise more frequent captures inside \"events\": event starts default 30mins before sunrise/sunset ends 30mins . configurable.gamma correction tool support be disabled runtime (---gamma cmdline switch) case huge brightness drop (> 60%), new capture quickly done ( 15 seconds), check this was accidental event (eg: changed room capture happened before switched the light) if brightness has really dropped much (eg: switched off light)conf file placed both /etc/default $xdg_config_home (fallbacks $home/.config/) support 1 clight instance be running same user. can still invoke fast capture an instance is already running, obviouslysweet inter-modules dependencies management system \"modules\"(capture, gamma, location, etc etc) lazy loading: every module only started the right , eg: gamma module only started a location has been retrieved.upower support, set longer timeouts between captures while battery, order save energy.moreover, can set percentage maximum settable brightness while battery. can specify curve points be used match ambient brightness screen backlight config file. more info, polynomial fit section below.gracefully auto-disabling gamma support non-x environments.valgrind is run :$ alias valgrind='valgrind --tool=memcheck --leak-check=full --track-origins=yes --show-leak-kinds= -v'cppcheck is run :$ cppcheck --enable=style --enable=performance --enable=unusedfunction cmdline options, check clight [-?|--help] [--usage].please note cmdline \"--device\" \"--backlight\" switches require last part syspath (eg: \"video0\" \"intel_backlight\"). your backlight interface completely dim screen 0 backlight level, sure set your conf file ( through cmdline option) lowest_backlight_level option.config file global config file is shipped clight. is installed /etc/default/clight.conf it is commented. can customize or can copy in $xdg_config_home folder (fallbacks $home/.config/) customize there.both files are checked clight starts, this order: global -> user-local -> cmdline opts.polynomial fitclight makes of gnu scientific library compute best-fit around data points read clight.conf file.default values are [ 0.0, 0.15, 0.29, 0.45, 0.61, 0.74, 0.81, 0.88, 0.93, 0.97, 1.0 ]; indexes ( 0 10 included) are x axys (ambient brightness), while values are y axys (screen backlight). example, default values, 0.5 ambient brightness (6th value this array) clight set 74% max backlight level. customizing values, can adapt screen backlight curve meet needs. note values must between 0.0 1.0 obviously.gamma support infogamma support is available x. sadly wayland is still standard to achieve gamma correction. let's with fingers crossed.consequently, not x environments, gamma correction tool gets autodisabled. clightd getgamma function properly supports 50-steps temperature values (ie you \"setgamma 6000\" then getgamma, will return 6000. you setgamma 4578, getgamma won't return exactly ; it return 4566 something similar.), not set your conf -50-multiple temperatures.moreover, since is still standard to deal gamma correction wayland, is supported x11. you run clight wayland from tty, gamma support be automatically disabled. info can run clight instance per-user: a clight instance is running, cannot start another full clight instance.obviously can still invoke \"clight -c\" a terminal/shortcut make fast capture/screen brightness calibration. is achieved through clight.lock file placed current user home.every functionality clight is achieved through \"module\". inter-modules dependencies system has been created ad-hoc ease development such modules. way, does matter modules' init calls sorting; moreover, each module be easily disabled not needed (eg: --no-gamma option is passed.)build instructions:build install:$ # make installuninstall:# uninstallarch aur packagesclight is available aur: https://aur.archlinux.org/packages/clight-git/ .deb packagesdeb package amd64 architecture is provided each release.moreover, can very easily build own packages, you wish test latest clight code. only need issue:$ deb deb file be created \"debian\" folder, inside clight root.please note while am using debian testing my job, am developing clightd archlinux.thus, can encounter packaging issues. please, report .license software is distributed gpl license, copying file more informations."
}