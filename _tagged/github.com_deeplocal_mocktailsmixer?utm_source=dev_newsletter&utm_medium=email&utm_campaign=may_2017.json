{
	"_id": "14419774",
	"site": "https://github.com/deeplocal/mocktailsmixer?utm_source=dev_newsletter&utm_medium=email&utm_campaign=may_2017",
	"title": "GitHub – Deeplocal/mocktailsmixer: Make a DIY Robotic Mocktails Mixer",
	"author": "megahz",
	"date": "2017-06-13T13:56:32.086Z",
	"tags": {
		"categories": [
			"opensource",
			"github",
			"diy"
		],
		"languages": [
			"python",
			"arduino",
			"javascript"
		]
	},
	"content": "readme.md google assistant sdk demo: mocktails mixer a diy robotic mocktails mixer the google assistant built .google teamed with innovation studio deeplocal create google assistant sdk: mocktails mixer diy robotic home bartender whips your favorite mixed drinks your command serves a splash small talk while wait.disclaimer: instructions are being provided informational purposes and are intended be used the production commercial products. executing instructions, agree assume liability connection your building use any device. deeplocal disclaims warranties express implied respect these instructions any resulting device including not limited warranties merchantability, fitness any particular purpose, non-infringement. should extreme caution building using device pursuant these instructions. no event shall deeplocal liable any claim damages, including not limited claims damages related death personal injury, property damage, product liability.project informationestimated to assemble: 15 hoursdifficulty: intermediatecost: $570features:voice-controlled drink ordering ( chitchat!)modular design allows to customize mixer include many ingredients drink combinations you choose model inspiration other projects integrate google assistant sdk youll finddiagrams/hardware/cad/laser-cut/photos/bill materialssoftware/arduino/rpi/gcf/api.ai agent zip you'll needbefore get started, should a basic knowledge soldering. should have access a laser cutter. can find of parts used, along the exact quantity, supplier, cost, links purchase here.note: general, used parts were readily available, on expensive side. build be completed less expense parts are sourced amazon/alibaba if lower quality parts are used.note: materials used this build are rated food safe. liquid does come contact any material is food grade safe.tools needed the build are listed below:hand drillrubber mallet hammerscrewdriver setx-acto knifesoldering ironwire cutterswire strippersscissorshex key setwrench setbuilding mixer bodystep 1: laser cuttinglaser cut 2d profiles the acrylic sheets.note: dfxs are in inches. please scale according input laser cutter. attached drawings design guidance.. top panel- ¼ inch thickb. bottle capture panel- ¼ inch thickc. lid capture panel- ¼ inch thickd. drip panel- ¼ inch thicke. pump-relay control panel- ¼ inch thickf. pour panel- ¼ inch thickg. bottom panel- ¼ inch thickh. inside side panel- ¼ inch thick. outside side panel-¼ inch thickj. inside side button panel-¼ inch thickk. outside side button panel- ¼ inch thickl. front panel- ¼ inch thickm. rear panel- ¼ inch thickn. cup indicator panel- 1/16 inch thicko. arduino top plate- 1/16 inch thickp. arduino bottom plate- 1/16 inch thickq. speaker diffusion levelr. speaker clear level 16th- 1/16 inch thicks. speaker black level 8th- inch thickt. speaker black level 8th 1- inch thicku. speaker black level 4th 1- ¼ inch thickstep 2: assemble bottle holder subattach top panel bottle capture panel together #10-32 x 1/2 inch length button socket cap #10-32 x 1 inch length ¼ od standoff. the side, lid capture panel 10-32 x ¾ inch length button socket cap fasteners (optional - double sided tape be used attach lid capture panel the bottom the bottle capture panel).note: is ¼ inch overhang the top panel. rear panels are flush the exception the tabs.step 3: assemble pump relay control panel subnote: ensure pump tubing is food grade safe, please replace tygon clear pvc tubing 3/32 inch id x 5/32 inch od (hardness rating is soft durometer is 65a). durometer is imperative pump tube life. can found mcmaster-carr.install food grade pump tubing.remove cover pumps depressing snaps both sides pump head. remove tubing was placed during shipment. place food grade tubing pump allowing 3 inches remain outside inlet outlet the pump. , be careful not puncture tubing installing around rollers.attach pumps. pump/relay control panel attach peristaltic pumps the eight 1.10 inch diameter holes located the panel. a #2-56 x ½ inch length phillips pan head machine screw corresponding nut fasten pumps the acrylic. place #8 black rubber washer between pump acrylic reduce vibration.attach relays.attach beef cake relays directly above each pump the pump/relay control panel. will a 4 bolt hole pattern. the #2-56 x inch length inch od standoffs (optional - can #2-56 x 1/2 inch length phillips pan head machine screw corresponding nut instead the standoffs.) number #2 washers underneath each hole before standoff. fasten each corner a #2-56 x 5/32 inch length phillips pan head machine screw. note the red led must positioned toward top the acrylic sheet. a #2-56 x inch length pan head phillips machine screw fasten relays other side acrylic.tip: attaching fasteners, washers standoffs the relays, allow to loose. will help easy alignment the corresponding holes the acrylic retighten fasteners relays.attach arduino amp mount.place arduino between arduino top plate arduino bottom plate. , place 4 #8 rubber washers between help keep spacing the board . using #8-32 ¼ inch hex 3/8 length standoffs secure assembly together a #8-32 nut. 2 holes located the arduino bottom plate are the amp. place 2 #2-56 inch length inch od standoffs place corresponding #2-56 inch length phillips pan head machine screw. 2 more #2-56 x inch length phillips pan head machine screws secure amp mount.attach raspberry pi drip panel.attach raspberry pi the underside the drip panel. the correct orientation, board be flipped upside down the large hole be towards back left corner. attach board 4 #2-56 x 5/32 inch length phillip pan head machine screws 4 #2-56 x inch length od standoffs. sub-assembly attach the four corresponding holes the drip panel. another four #2-56 x 3/8 inch length phillip pan head machine screws through acrylic the standoffs.wiring electrical systemelectrical system overview a clearer view the wiring diagram download fritzing file.control electrical system the mocktails mixer uses control systems. first is raspberry pi, handles of communication the google assistant sdk. second is arduino micro controls pumps leds. both these systems are connected each over serial. raspberry pi sends commands the arduino what lights pumps turn and arduino executes .outside these controllers, mocktails mixer has four major hardware systems. are power, pumping system, lights, audio.power power system controls flow electricity the mixer. however, mixer uses different voltages: 12v the pumps 5v the hardware. can handle by using step-down voltage regulator a dual-voltage power supply. are both adequate the basic build the mixer, if want add extra flair ( more leds), may need use separate power supplies. instructions bom two power supplies.note: safety, recommend placing power supply an external enclosure keep 110v away the liquids the mixer.pumps this version the mocktails mixer, used eight (8) peristaltic pumps. are rated recommended use 12v, you run up 24v you find the pumps are running too slow. pumps are individually switched a relay controlled the arduino micro.lighting visual feedback, added led ring the mixer. used adafruit neopixel. is very easy wire add additional rings, plus library is easy use. draw decent amount amperage, if want add more your build, will need size 5v power supply accordingly.audiolast not least, used usb microphone speak the assistant is connected directly the raspberry pi. speaker is connected the amplifier the arduinos mounting plate. amplifier is connected the raspberry pi via 3.5 mm headphone jack.electrical system wiring instructionsstep 4: wire power supplies wire power supply, connect ac lines their terminals (black l load, white n neutral, green ground). next, connect dc power lines power supplies.note: make wiring easier follow, used red wire all 12v lines green all the 5v lines. kept all the ground wires black all devices need share ground order communicate.note: also recommend using lower gauge wire (12 14 gauge), the dc power lines moving the power supply the terminal block the wire nut, using higher gauge (20 24 gauge) all the lines.step 5: wire pumps relaysbefore start wire pumps relays, assemble relays. used sparkfun beefcake relays this build the assembly instructions them be found here. like because are easy use readily available cheaper alternatives are available.next, mount of pumps relays pump-relay control panel. we are ready wire pumps relays. connect 5v lines the 5v terminal the relays. daisy chained lines across relays reduce amount wires going the main 5v terminal.similarly the 5v power, connect ground wires the gnd terminals the relays, daisy chaining .next, connect control lines the ctrl terminal their respective pins the arduino. make connecting control lines the arduino easier, waited until were plugged before mounted arduino; way could still read pin locations the or reset arduino necessary. pin-outs the arduino are:pump 1 relay pin 2pump 2 relay pin 3pump 3 relay pin 4pump 4 relay pin 5pump 5 relay pin 7pump 6 relay pin 8pump 7 relay pin 9pump 8 relay pin 10note: not pin 6 trigger relay. reserved pin control lights it is pwm pin the arduino. provide power the pumps, connect 12v lines the com terminal the relay ( daisy-chained), connect positive (red) terminal the pump the terminal the relay.finally, wrap all , connect ground lines the negative terminal the pump.since four pumps the right side the mixer are mounted reverse, need change rotation the pump also reversed. do , we switch ground line the positive terminal the power line the relay the negative terminal.step 6: wire ledswiring neopixel led ring is very easy. solder data line pin 6 the arduino the din pin, connect 5v line 5v the ground line gnd. you like add more led rings, you need do is wire dout the ring the din the next ring. , just connect 5v grounds both rings together.step 7: wire audiosince microphone is usb controlled, is wiring necessary. however, speaker needs be hooked to amp, to raspberry pi., complete assembly the amplifier, soldering headers terminal block the board.next, ll connect ground line the ground pin the amp, the 5v line the 2-5v pin the amplifier.using audio cable the 3.5 mm jack, connect positive line the + pin, connect negative line the - pin. your cable has ground cable, connect to ground pin well. all need do is connect speaker. connect speakers positive negative wires their respective terminal the amp.slight interference occur the speaker, of we recommend add capacitor between a+ a- pins.final connections power raspberry pi, connect ground line a ground pin the pi, connect 5v line the 5v on pi. activate assistant, is button the side you push. wire button, connect com terminal the 3.3v on raspberry pi. , connect no terminal the button the buttons respective gpio ( our case gpio 7). a cleaner signal, connect resistor between no terminal ground.double check wiring. trace of from each piece hardware their source. once feel about wiring, ahead power the system. raspberry pi should a red power light visible the arduino should a blue power light visible well.building mixer body continuedstep 8: assemble pump control center subassemble pump/relay control panel between drip panel pour panel corresponding tabs slots each sheet acrylic. sure pumps relays face front the unit are front the pour holes the center pour plate. 10-32 standoffs 10-32 fasteners bring sub-assembly together. #10-32 x ½ inch length all thread be used bring #10-32 x 2 inch length standoff #10-32 x 3 inch length standoffs together.step 9: assemble side panel subattach outside side panel inside side panel using #8-32 binding posts (optional - can omit from build. help holding side panels together while assembling). flat side the binding post should face inside side panel. six the binding posts be used per side assembly.repeat inside side button panel outside side button panel. side panel assembly the button be the right side the unit looking the unit the front.step 10: assemble cup indication bottom panelattach cup indicator panel bottom panel #8-32 low profile binding barrels. (optional - cup indicator helps user where place cup is necessary the assembly).step 11: bring the sub-assemblies togetherbegin laying side assembly its face slots facing upwards. will allow easy installation the components.attach bottle holder sub-assembly the top the side panel assembly aligning slots. note the tabs the rear must face rear the unit.next, attach pump/relay control panel sub-assembly right below bottle holder sub-assembly, noting the tabs align before. note the pumps must facing towards front the unit the electric motor faces rear. front the unit be determined the amount space between slots the edge side panels larger gap indicates front the unit.attach bottom panel the last remaining slots towards bottom the side panel assembly.attach other side panel assembly, mating tabs slots. the #10-32 x 1 inch length button socket cap corresponding square nuts secure unit. are six these per side.rotate unit 180 degrees fasten other six fasteners. tip: careful rotating unit make sure firmly hold two side panel assemblies together. second person may helpful here.step 12: cut fit fluid delivery tubes length installbegin taking ¼ inch od tubing (food safe) run from each pump through holes the drip panel. leave additional 8-10 inches extra tubing easily remove bottle.next using tube connectors run ¼ inch od tubing (food safe) the pump outlet the pour holes the center the pour panel. tubes fit snuggly each the 8 holes. are made have slight interference fit.step 13: assembly speaker subassemble speaker panels together through front panel #4-40 x 1.25 inch length phillips head machine screws corresponding nuts. layer speaker sub assembly the following order pictured below.step 14: attach front panel unitattach front panel unit 10-32 x ¾ inch length button socket cap corresponding square nuts. are of that hold panel place.tip: a piece painters tape hold square nuts place until fasteners grab. tape be removed through bottle holes.step 15: attach rear panel unitalign rear panel the corresponding slots tabs the rear the unit. once again, the #10-32 x ¾ inch length button socket cap respective square nuts.bottle buildstep 16: cut hole bottle seal an x-acto knife carefully cut round hole the center the bottle cap seal.step 17: drill hole tube connectorsusing 0.15-inch diameter drill bit, drill holes across each in center the lid. can an x-acto knife deburr edges around hole.remove loose debris drilling. holes be used attach tube connectors.step 18: attach tube connectorsapply rubber washers each the tube connectors. a hammer socket head press fit connector the lid. will hear audible click the connector is seated properly. process help ensure leaking occurs.step 19: attach tubing check valvecut 2-inch length ¼-inch od tubing attach to connector the outside the lid pictured below.next, attach check valve the end this tubing. note flow valve going the bottle. air only in liquid cannot out.step 20: place bottle assembly unitfill bottles desired liquid, before flipping , attach ¼ od food safe tubing coming the pumps the open connection the bottle.once is done, carefully flip bottle into of bottle holding locations.programming mixermixer programming overview: do rpi assistant sdk communicate the pumps? user presses physical button start google assistant speaks drink request the microphone. local python application picks the speech transmits to api.ai processing using assistant sdk. api.ai agent parses input, determines context intent, processes request. a drink request: api.ai agent uses webhook process request. webhook is external url endpoint existing a google cloud function written node.js.requests also fulfilled natively the api.ai platform. webhook receives make_drink intent specific drink entity the request, publishes relevant info a pub/sub route, returns response text the user. local python application receives parses pub/sub message, calculates many seconds each relay should turned , and transmits those commands the arduino via serial. arduino uses gpio control relays dispense drink.step 21: create google cloud platform projectcreate new project the google developers consolelocate project id the dashboard note later . (read here help)enable pub/sub api create topic named \"mocktailsmixermessages.\" (read here help)step 22: create google cloud functionclone repository your local machine.update -google-project-id line 7 software/gcf/index.js.create zip file including package.json index.js the software/gcf/ directory.navigate the cloud functions console a browser.ensure correct project is selected the dropdown the top the page.click create function.fill the form the following info:name: apiai-webhookregion: (choose region nearest your location)memory allocated: 128 mbtimeout: 60 secondstrigger: http trigger (note http trigger url later )source code: zip uploadzip file: (choose zip file created above)stage bucket: (choose bucket)function execute: webhookclick createstep 23: set an api.ai agenttip: may to review actions google developer guide an introduction conversational user interfaces.sign the api.ai console. the agents page, click create agent. your agent name. select private click save.navigate the agent fulfillment page.flip enabled toggle , enter http trigger url the google cloud function the url field, click save.navigate the agent settings page.select export import tab click import zip button.select apiai_mocktailsmixer.zip file the cloned repository import.navigate the agent integrations page:flip actions google integration and fill the form.select authorize then preview. note: previews are available a period time. deploy register conversation action google. registration process take to weeks. read more here.test agent the google home web simulator.create sd card raspbian jessie pixel.download compressed image decompress file. ( should result yyyy-mm-dd-raspbian-jessie.img)insert 8gb+ microsd card computer. a mac, open terminal perform following:find correct disk using command $ diskutil list. re looking the entire disk .e. /dev/diskn.unmount disk using command $ diskutil unmountdisk /dev/diskn.write image the disk using command $ sudo dd bs=1m =/path//yyyy-mm-dd-raspbian-jessie.img =/dev/rdiskn.(note additional r the output file path. patient - is feedback this command it take several minutes. warning: $ sudo dd is very powerful command double-check have correct disk.) the image has been written, eject microsd card insert into raspberry pi. windows instructions, here linux instructions, herestep 24: follow steps getting started the raspberry pi python.before section connect the raspberry pi via ssh, must enable ssh. a mac, perform following using terminal:change directory the root the microsd card: $ cd /volumes/bootcreate empty ssh file no extension: $ touch ssh section configure new python virtual environment, used python 3.before section configure test audio, plug a usb microphone 3.5mm speaker your raspberry pi.step 25: install additional raspberry pi librarieschange directory: $ cd /home/pi/install rpi.gpio: $ env/bin/pip3 install rpi.gpioinstall python pubsub: $ env/bin/pip3 install google-cloud-pubsubinstall pyserial: $ python -m pip install pyserial --upgradeinstall pyaudio: $ python -m pip install pyaudiostep 26: clone code repository rpi move files correct locationchange directory: $ cd /home/pi/clone repository: $ git clone https://github.com/deeplocal/mocktailsmixer.git.update pubsub_project_id mocktailsmixer/software/rpi/__main__.pycopy files embedded assistant directory: $ cp -r mocktailsmixer/software/rpi embedded-assistant-sdk-python/googlesamples/step 27: prepare arduinoload sketch onto board.connect raspberry pi via usb.step 28: run systemensure are still the python virtual environment. not: $ cd && source env/bin/activate.change directory: $ cd /home/pi/embedded-assistant-sdk-pythonrun auth_helper create authorization file: $ python -m googlesamples.rpi.auth_helpers --client-secrets /home/pi/client_secret_*.json.run system $ python -m googlesamples.rpi.step 29: configure own drinksusing api.ai web console, update agents @drink entity make_drink intent reflect drink names. your raspberry pi, update drink_size, menu num_bottles variables bartender/__main__.py.step 30: troubleshooting the leds relays are working, check ser_device variable bartender/__main__.py.example transcript(user presses physical button.)user: tell mocktails mixer make a cherry bomb.assistant: coming right . while make drink, you to hear weather your fortune?user: about weather?assistant: is zip code?user: 15212.assistant: weather pittsburgh, pa is 75 degrees sunny.cleaning mixer use, empty bottles earlier contents rinse water.fill each bottle water run mixer clean lines any residue may left behind. will keep mixer clean ready the next you change liquids.run mixer pumps until liquid be seen coming . this ensure liquid is left the lines.remove bottles mixer allow to dry rinsing out.periodically check hoses connections prevent leaks developing."
}