{
	"_id": "14477195",
	"site": "https://github.com/CalebFenton/apkfile",
	"title": "Apkfile â€“ Android app analysis and feature extraction library",
	"author": "tekproxy",
	"date": "2017-06-13T13:55:02.450Z",
	"tags": {
		"categories": [
			"opensource",
			"android",
			"reverse-engineering",
			"malware-analysis",
			"malware-research"
		],
		"languages": [
			"java"
		]
	},
	"content": "readme.md apkfileapkfile is library creates representation an apk composed java objects can easily inspected analysis serialized json. goal the library is provide robust to inspect hostile malware samples, it's general purpose enough be used other stuff too.usage main object is apkfile it extends java.io.file:apkfile apkfile = apkfile('apidemos.apk');androidmanifest androidmanifest = apkfile.getandroidmanifest();string packagename = androidmanifest.getpackagename(); // com.example.android.apisapkfile provides objects :android manifestresources via modified & hardened arscblamersigning certificatedex files via dexlib2jar (zip) entriesserializing jsonbelow is example how stream apkfile json:apkfile apkfile = apkfile(\"ignore/droidswarm-1.0.1.apk\");gsonbuilder gsonbuilder = gsonbuilder();// these settings handle odd strings floating point values \"nan\":gson gson = gsonbuilder().disablehtmlescaping().serializespecialfloatingpointvalues().setprettyprinting().create();// don't create json string since 's huge. instead, stream out.writer writer = outputstreamwriter(system.);gson.tojson(apkfile, writer);writer.close();apkfile.close();below is highly abbreviated output the code above. full version be found here.{ \"androidmanifest\": { \"application\": { \"activities\": [ { \"allowembedded\": false, \"allowtaskreparenting\": false, \"alwaysretaintaskstate\": false, \"autoremovefromrecents\": false, \"banner\": \"\", \"cleartaskonlaunch\": false, \"configchanges\": 0, \"documentlaunchmode\": 0, \"excludefromrecents\": false, \"finishontasklaunch\": false, \"hardwareaccelerated\": false, \"launchmode\": 0, \"maxrecents\": 16, \"multiprocess\": false, \"nohistory\": false, \"parentactivityname\": \"\", \"persistablemode\": 0, \"relinquishtaskidentity\": false, \"resizeableactivity\": false, \"screenorientation\": 0, \"showforallusers\": false, \"statenotneeded\": false, \"supportspictureinpicture\": false, \"taskaffinity\": \"\", \"theme\": \"\", \"uioptions\": 0, \"windowsoftinputmode\": 0, \"intentfilters\": [ { \"actions\": [ \"android.intent.action.main\" ], \"categories\": [ \"android.intent.category.launcher\" ], \"data\": [], \"icon\": \"\", \"label\": \"\", \"priority\": 0 } ], \"metadata\": [], \"directbootaware\": false, \"enabled\": true, \"exported\": false, \"icon\": \"\", \"label\": \"droidswarm\", \"name\": \"com.soong.droidswarm.main\", \"permission\": \"\", \"process\": \"\" }, // ** snip ** ], \"activityaliases\": [], \"allowtaskreparenting\": false, \"allowbackup\": true, \"backupagent\": \"\", \"backupinforeground\": false, \"banner\": \"\", \"debuggable\": true, \"description\": \"\", \"directbootaware\": false, \"enabled\": true, \"extractnativelibs\": true, \"fullbackupcontent\": \"\", \"fullbackuponly\": false, \"hardwareaccelerated\": true, \"hascode\": true, \"icon\": \"res/drawable-mdpi/ic_launcher.png\", \"isgame\": false, \"killafterrestore\": true, \"largeheap\": false, \"label\": \"droidswarm\", \"logo\": \"\", \"managespaceactivity\": \"\", \"name\": \"\", \"networksecurityconfig\": \"\", \"permission\": \"\", \"persistent\": false, \"process\": \"\", \"providers\": [], \"receivers\": [], \"restoreanyversion\": false, \"requiredaccounttype\": \"\", \"resizableactivity\": false, \"supportsrtl\": false, \"services\": [ { \"isolatedprocess\": false, \"intentfilters\": [], \"metadata\": [], \"directbootaware\": false, \"enabled\": true, \"exported\": false, \"icon\": \"\", \"label\": \"\", \"name\": \"com.soong.droidswarm.swarmservice\", \"permission\": \"\", \"process\": \"\" } ], \"taskaffinity\": \"\", \"theme\": \"\", \"uioptions\": 0, \"usescleartexttraffic\": true, \"vmsafemode\": false, \"useslibraries\": [] }, \"compatiblescreens\": [], \"hasresources\": true, \"installlocation\": 0, \"instrumentations\": [], \"maxsdkversion\": 0, \"minsdkversion\": 7, \"packagename\": \"com.soong.droidswarm\", \"permissiongroups\": [], \"permissiontrees\": [], \"permissions\": [], \"platformbuildversioncode\": -1, \"platformbuildversionname\": \"\", \"shareduserid\": \"\", \"shareduserlabel\": \"\", \"supportsgltextures\": [], \"targetsdkversion\": 0, \"usesconfigurations\": [], \"usesfeatures\": [], \"usespermissions\": [ \"android.permission.internet\", \"android.permission.write_external_storage\", \"android.permission.access_network_state\", \"android.permission.change_wifi_state\" ], \"versioncode\": 5, \"versionname\": \"0.9.2\" }, \"certificate\": { \"allrdns\": [ { \"issuerrdns\": { \"c\": \"\", \"cn\": \"android debug\", \"o\": \"android\" }, \"subjectrdns\": { \"c\": \"\", \"cn\": \"android debug\", \"o\": \"android\" } } ] }, \"entrynametodex\": { \"classes.dex\": { \"apicounts\": { \"landroid/text/editable;->tostring()ljava/lang/string;\": 8, \"ljava/util/concurrent/threadpoolexecutor;-><init>(iijljava/util/concurrent/timeunit;ljava/util/concurrent/blockingqueue;ljava/util/concurrent/rejectedexecutionhandler;)v\": 1, \"landroid/content/pm/packagemanager;->getpackageinfo(ljava/lang/string;)landroid/content/pm/packageinfo;\": 2, \"ljava/lang/object;->tostring()ljava/lang/string;\": 1, \"ljava/lang/long;->valueof(j)ljava/lang/long;\": 2, \"landroid/widget/checkbox;->ischecked()z\": 1, \"landroid/widget/listview;->setadapter(landroid/widget/listadapter;)v\": 2, \"ljava/lang/charsequence;->tostring()ljava/lang/string;\": 1, \"ljava/util/iterator;->hasnext()z\": 9, \"ljava/lang/string;->tolowercase()ljava/lang/string;\": 1, \"landroid/widget/seekbar;->getmax()\": 1, \"landroid/app/alertdialog;->setmessage(ljava/lang/charsequence;)v\": 1, // ** snip ** }, \"classaccessorcounts\": { \"interface\": 2, \"final\": 7, \"protected\": 0, \"private\": 0, \"synchronized\": 0, \"abstract\": 2, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 22, \"static\": 0, \"strict\": 0 }, \"classpathtoclass\": { // * snip ** \"lcom/soong/droidswarm/swarmmonitor;\": { \"apicounts\": { \"ljava/lang/thread;->sleep(j)v\": 1, \"ljava/lang/long;->valueof(j)ljava/lang/long;\": 2, \"ljava/io/printstream;->println(ljava/lang/string;)v\": 1, \"ljava/util/arraylist;->(i)ljava/lang/object;\": 1, \"ljava/util/concurrent/threadpoolexecutor;->getmaximumpoolsize()\": 1, \"ljava/util/concurrent/threadpoolexecutor;->execute(ljava/lang/runnable;)v\": 1, \"ljava/lang/integer;->valueof()ljava/lang/integer;\": 5, \"ljava/util/concurrent/threadpoolexecutor;->getactivecount()\": 1, \"ljava/util/concurrent/threadpoolexecutor;->gettaskcount()j\": 1, \"ljava/lang/object;-><init>()v\": 1, \"ljava/lang/string;->format(ljava/lang/string;[ljava/lang/object;)ljava/lang/string;\": 1, \"ljava/util/concurrent/threadpoolexecutor;->getpoolsize()\": 2, \"ljava/util/concurrent/threadpoolexecutor;->isshutdown()z\": 3, \"ljava/util/concurrent/threadpoolexecutor;->getcorepoolsize()\": 1, \"ljava/util/concurrent/threadpoolexecutor;->getcompletedtaskcount()j\": 1, \"ljava/util/concurrent/threadpoolexecutor;->isterminated()z\": 1 }, \"classaccessors\": { \"interface\": 0, \"final\": 0, \"protected\": 0, \"private\": 0, \"synchronized\": 0, \"abstract\": 0, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 1, \"static\": 0, \"strict\": 0 }, \"fieldreferencecounts\": { \"ljava/lang/system;->:ljava/io/printstream;\": 1 }, \"methodaccessorcounts\": { \"interface\": 0, \"final\": 0, \"protected\": 0, \"private\": 0, \"synchronized\": 0, \"abstract\": 0, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 2, \"static\": 0, \"strict\": 0 }, \"methodsignaturetomethod\": { \"run()v\": { \"apicounts\": { \"ljava/util/concurrent/threadpoolexecutor;->getactivecount()\": 1, \"ljava/lang/thread;->sleep(j)v\": 1, \"ljava/util/concurrent/threadpoolexecutor;->execute(ljava/lang/runnable;)v\": 1, \"ljava/lang/long;->valueof(j)ljava/lang/long;\": 2, \"ljava/util/concurrent/threadpoolexecutor;->getcompletedtaskcount()j\": 1, \"ljava/util/arraylist;->(i)ljava/lang/object;\": 1, \"ljava/util/concurrent/threadpoolexecutor;->getmaximumpoolsize()\": 1, \"ljava/lang/integer;->valueof()ljava/lang/integer;\": 5, \"ljava/util/concurrent/threadpoolexecutor;->gettaskcount()j\": 1, \"ljava/util/concurrent/threadpoolexecutor;->isterminated()z\": 1, \"ljava/lang/string;->format(ljava/lang/string;[ljava/lang/object;)ljava/lang/string;\": 1, \"ljava/util/concurrent/threadpoolexecutor;->getpoolsize()\": 2, \"ljava/util/concurrent/threadpoolexecutor;->getcorepoolsize()\": 1, \"ljava/io/printstream;->println(ljava/lang/string;)v\": 1, \"ljava/util/concurrent/threadpoolexecutor;->isshutdown()z\": 3 }, \"fieldreferencecounts\": { \"ljava/lang/system;->:ljava/io/printstream;\": 1 }, \"methodaccessors\": { \"interface\": 0, \"final\": 0, \"protected\": 0, \"private\": 0, \"synchronized\": 0, \"abstract\": 0, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 1, \"static\": 0, \"strict\": 0 }, \"opcounts\": { \"move_result\": 12, \"if_nez\": 1, \"add_int_lit8\": 1, \"if_ge\": 1, \"if_lez\": 1, \"move_exception\": 1, \"sget_object\": 1, \"move_result_wide\": 2, \"rem_int\": 1, \"goto\": 4, \"if_eqz\": 5, \"check_cast\": 1, \"const_string\": 1, \"new_array\": 1, \"invoke_direct\": 1, \"if_le\": 1, \"move_result_object\": 9, \"invoke_static\": 9, \"iget_object\": 17, \"iget_boolean\": 2, \"return_void\": 1, \"aput_object\": 7, \"invoke_virtual\": 17, \"new_instance\": 1, \"move\": 4, \"const_4\": 12, \"const_wide_16\": 1 }, \"stringreferencecounts\": { \"[swarm-mon] [%d/%d] active:%d, completed:%d task:%d isshutdown:%s isterminated:%s\": 1 }, \"annotationcount\": 0, \"cyclomaticcomplexity\": 19, \"debugitemcount\": 31, \"instructioncount\": 115, \"registercount\": 11, \"trycatchcount\": 1 }, \"<init>(ljava/util/concurrent/threadpoolexecutor;lcom/soong/droidswarm/targetlist;)v\": { \"apicounts\": { \"ljava/lang/object;-><init>()v\": 1 }, \"fieldreferencecounts\": {}, \"methodaccessors\": { \"interface\": 0, \"final\": 0, \"protected\": 0, \"private\": 0, \"synchronized\": 0, \"abstract\": 0, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 1, \"static\": 0, \"strict\": 0 }, \"opcounts\": { \"return_void\": 1, \"invoke_direct\": 1, \"const_4\": 1, \"iput_boolean\": 1, \"iput_object\": 2 }, \"stringreferencecounts\": {}, \"annotationcount\": 0, \"cyclomaticcomplexity\": 1, \"debugitemcount\": 6, \"instructioncount\": 6, \"registercount\": 4, \"trycatchcount\": 0 } }, \"opcounts\": { \"move_result\": 12, \"if_nez\": 1, \"add_int_lit8\": 1, \"if_ge\": 1, \"if_lez\": 1, \"move_exception\": 1, \"sget_object\": 1, \"move_result_wide\": 2, \"rem_int\": 1, \"goto\": 4, \"if_eqz\": 5, \"check_cast\": 1, \"new_array\": 1, \"invoke_direct\": 2, \"iput_boolean\": 1, \"if_le\": 1, \"new_instance\": 1, \"move_result_object\": 9, \"invoke_static\": 9, \"iget_object\": 17, \"iput_object\": 2, \"iget_boolean\": 2, \"return_void\": 2, \"aput_object\": 7, \"invoke_virtual\": 17, \"const_string\": 1, \"move\": 4, \"const_4\": 13, \"const_wide_16\": 1 }, \"stringreferencecounts\": { \"[swarm-mon] [%d/%d] active:%d, completed:%d task:%d isshutdown:%s isterminated:%s\": 1 }, \"annotationcount\": 0, \"cyclomaticcomplexity\": 10.0, \"debugitemcount\": 37, \"fieldcount\": 3, \"instructioncount\": 121, \"registercount\": 15, \"trycatchcount\": 1, \"failedmethods\": 2 }, }, \"fieldreferencecounts\": { \"landroid/widget/adapterview$adaptercontextmenuinfo;->position:\": 1, \"ljava/lang/boolean;->false:ljava/lang/boolean;\": 1, \"ljava/util/concurrent/timeunit;->seconds:ljava/util/concurrent/timeunit;\": 1, \"ljava/lang/integer;->type:ljava/lang/class;\": 1, \"landroid/app/notification;->flags:\": 2, \"ljava/lang/boolean;->type:ljava/lang/class;\": 2, \"ljava/lang/system;->:ljava/io/printstream;\": 2, \"landroid/os/message;->:i\": 1, \"ljava/lang/boolean;->true:ljava/lang/boolean;\": 2, \"landroid/content/pm/packageinfo;->versionname:ljava/lang/string;\": 2, \"landroid/os/message;->obj:ljava/lang/object;\": 2 }, \"methodaccessorcounts\": { \"interface\": 0, \"final\": 0, \"protected\": 12, \"private\": 28, \"synchronized\": 0, \"abstract\": 2, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 66, \"static\": 23, \"strict\": 0 }, \"methoddescriptortomethod\": { \"lcom/soong/droidswarm/externalstorage$1;->onreceive(landroid/content/context;landroid/content/intent;)v\": { \"apicounts\": { \"landroid/util/log;->(ljava/lang/string;ljava/lang/string;)\": 1, \"ljava/lang/stringbuilder;->append(ljava/lang/object;)ljava/lang/stringbuilder;\": 1, \"ljava/lang/stringbuilder;-><init>(ljava/lang/string;)v\": 1, \"landroid/content/intent;->getdata()landroid/net/uri;\": 1, \"ljava/lang/stringbuilder;->tostring()ljava/lang/string;\": 1 }, \"fieldreferencecounts\": {}, \"methodaccessors\": { \"interface\": 0, \"final\": 0, \"protected\": 0, \"private\": 0, \"synchronized\": 0, \"abstract\": 0, \"native\": 0, \"volatile\": 0, \"transient\": 0, \"public\": 1, \"static\": 0, \"strict\": 0 }, \"opcounts\": { \"invoke_direct\": 1, \"new_instance\": 1, \"invoke_static\": 2, \"move_result_object\": 3, \"invoke_virtual\": 3, \"return_void\": 1, \"const_string\": 2 }, \"stringreferencecounts\": { \"droidswarm\": 1, \"watching storage: \": 1 }, \"annotationcount\": 0, \"cyclomaticcomplexity\": 1, \"debugitemcount\": 4, \"instructioncount\": 13, \"registercount\": 6, \"trycatchcount\": 0 }, }, \"opcounts\": { \"invoke_interface\": 39, \"fill_array_data\": 1, \"new_array\": 10, \"sub_long_2addr\": 1, \"if_eqz\": 39, \"iget_boolean\": 5, \"move_object\": 6, // ** snip ** \"if_ge\": 2, \"packed_switch\": 1 }, \"stringreferencecounts\": { \"service disconnected.\": 1, \"file found.\": 2, \"importing target \": 1, \"name\": 2, \"\": 1, \"name required.\": 1, \"http://\": 1, \"received start id \": 1, // ** snip ** \" 9000!!\": 1, \"\": 9 }, \"annotationcount\": 2, \"cyclomaticcomplexity\": 1.888722, \"debugitemcount\": 1310, \"fieldcount\": 161, \"instructioncount\": 2684, \"registercount\": 604, \"trycatchcount\": 45, \"failedclasses\": 39 } }, \"entrynametozipentry\": { // ** snip ** \"androidmanifest.xml\": { \"name\": \"androidmanifest.xml\", \"xdostime\": 1128830327, \"crc\": 3833663256, \"size\": 2672, \"csize\": 846, \"method\": 8, \"flag\": 2056 }, \"classes.dex\": { \"name\": \"classes.dex\", \"xdostime\": 1128830327, \"crc\": 2086375952, \"size\": 54324, \"csize\": 21960, \"method\": 8, \"flag\": 2056 }, \"meta-inf/manifest.mf\": { \"name\": \"meta-inf/manifest.mf\", \"xdostime\": 1128830327, \"crc\": 1715315727, \"size\": 1314, \"csize\": 622, \"method\": 8, \"flag\": 2056 } }, \"path\": \"ignore/droidswarm-1.0.1.apk\"}licensecopyright 2017 rednaga. rights reserved.licensed under apache license, version 2.0 ( \"license\"); may use file except compliance the license. may obtain copy the license http://www.apache.org/licenses/license-2.0unless required applicable law agreed in writing, softwaredistributed under license is distributed an \" is\" basis,without warranties conditions any kind, either express implied. the license the specific language governing permissions limitations under license."
}